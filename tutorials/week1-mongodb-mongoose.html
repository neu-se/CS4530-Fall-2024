

<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">

  <link rel="stylesheet" href="/CS4530-Fall-2024/assets/css/just-the-docs-default.css">

  

  
    <script src="/CS4530-Fall-2024/assets/js/vendor/lunr.min.js"></script>
  

  <script src="/CS4530-Fall-2024/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>MongoDB and Mongoose | CS4530, Fall 2024</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="MongoDB and Mongoose" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Northeastern University CS 4530 “Fundamentals of Software Engineering”, Fall 2024. Professors Adeel Bhutta and Mitch Wand." />
<meta property="og:description" content="Northeastern University CS 4530 “Fundamentals of Software Engineering”, Fall 2024. Professors Adeel Bhutta and Mitch Wand." />
<link rel="canonical" href="https://neu-se.github.io/CS4530-Fall-2024/tutorials/week1-mongodb-mongoose" />
<meta property="og:url" content="https://neu-se.github.io/CS4530-Fall-2024/tutorials/week1-mongodb-mongoose" />
<meta property="og:site_name" content="CS4530, Fall 2024" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="MongoDB and Mongoose" />
<script type="application/ld+json">
{"description":"Northeastern University CS 4530 “Fundamentals of Software Engineering”, Fall 2024. Professors Adeel Bhutta and Mitch Wand.","headline":"MongoDB and Mongoose","dateModified":"2024-11-19T23:52:55+00:00","url":"https://neu-se.github.io/CS4530-Fall-2024/tutorials/week1-mongodb-mongoose","@type":"WebPage","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  

</head>

<body>
  <a class="skip-to-main" href="#main-content">Skip to main content</a>
  <svg xmlns="http://www.w3.org/2000/svg" class="d-none">
  <symbol id="svg-link" viewBox="0 0 24 24">
  <title>Link</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link">
    <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
  </svg>
</symbol>

  <symbol id="svg-menu" viewBox="0 0 24 24">
  <title>Menu</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu">
    <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>
  </svg>
</symbol>

  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
  <title>Expand</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right">
    <polyline points="9 18 15 12 9 6"></polyline>
  </svg>
</symbol>

  <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE -->
<symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link">
  <title id="svg-external-link-title">(external link)</title>
  <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line>
</symbol>

  
    <symbol id="svg-doc" viewBox="0 0 24 24">
  <title>Document</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file">
    <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline>
  </svg>
</symbol>

    <symbol id="svg-search" viewBox="0 0 24 24">
  <title>Search</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search">
    <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>
  </svg>
</symbol>

  
  
    <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md -->
<symbol id="svg-copy" viewBox="0 0 16 16">
  <title>Copy</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16">
    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
    <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/>
  </svg>
</symbol>
<symbol id="svg-copied" viewBox="0 0 16 16">
  <title>Copied</title>
  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16">
    <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/>
    <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/>
  </svg>
</symbol>

  
</svg>

  <div class="side-bar">
  <div class="site-header" role="banner">
    <a href="/CS4530-Fall-2024/" class="site-title lh-tight">
  CS4530, Fall 2024

</a>
    <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false">
      <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg>
    </a>
  </div>
  <nav aria-label="Main" id="site-nav" class="site-nav">
    
    
      <ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Calendar category" aria-pressed="false">
          <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
        </button><a href="/CS4530-Fall-2024/calendar/" class="nav-list-link">Calendar</a><ul class="nav-list"><li class="nav-list-item "><a href="/CS4530-Fall-2024/calendar/s1" class="nav-list-link">Section 1 - Calendar</a></li><li class="nav-list-item "><a href="/CS4530-Fall-2024/calendar/s2" class="nav-list-link">Section 2 - Calendar</a></li><li class="nav-list-item "><a href="/CS4530-Fall-2024/calendar/s5" class="nav-list-link">Section 5 - Calendar</a></li><li class="nav-list-item "><a href="/CS4530-Fall-2024/calendar/s8" class="nav-list-link">Section 8 - Calendar</a></li><li class="nav-list-item "><a href="/CS4530-Fall-2024/calendar/s9" class="nav-list-link">Section 9 - Calendar</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Modules category" aria-pressed="false">
          <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
        </button><a href="/CS4530-Fall-2024/modules/" class="nav-list-link">Modules</a><ul class="nav-list"><li class="nav-list-item "><a href="/CS4530-Fall-2024/modules/1-requirements-testing" class="nav-list-link">1 - Orientation & Requirements</a></li><li class="nav-list-item "><a href="/CS4530-Fall-2024/modules/2-requirements-to-code" class="nav-list-link">2 - From Requirements to Code</a></li><li class="nav-list-item "><a href="/CS4530-Fall-2024/modules/3-test-adequacy" class="nav-list-link">3 - Test Adequacy</a></li><li class="nav-list-item "><a href="/CS4530-Fall-2024/modules/4-code-level-design" class="nav-list-link">4 - Code-Level Design Principles</a></li><li class="nav-list-item "><a href="/CS4530-Fall-2024/modules/5-interaction-level-design-patterns" class="nav-list-link">5 - Interaction-Level Design Patterns</a></li><li class="nav-list-item "><a href="/CS4530-Fall-2024/modules/6-concurrency-patterns-in-typescript" class="nav-list-link">6 - Concurrency Patterns in Typescript</a></li><li class="nav-list-item "><a href="/CS4530-Fall-2024/modules/7-software-process" class="nav-list-link">7 - Software Process</a></li><li class="nav-list-item "><a href="/CS4530-Fall-2024/modules/8-react" class="nav-list-link">8 - React</a></li><li class="nav-list-item "><a href="/CS4530-Fall-2024/modules/9-patterns-of-react" class="nav-list-link">9 - React Hooks</a></li><li class="nav-list-item "><a href="/CS4530-Fall-2024/modules/10-ds-1" class="nav-list-link">10 - Distributed Systems Architectures (Part 1)</a></li><li class="nav-list-item "><a href="/CS4530-Fall-2024/modules/11-distributed-systems-2" class="nav-list-link">11 - Distributed Systems (Part 2)</a></li><li class="nav-list-item "><a href="/CS4530-Fall-2024/modules/12-larger-tests" class="nav-list-link">12 - Tests With Larger Scope</a></li><li class="nav-list-item "><a href="/CS4530-Fall-2024/modules/13-continuous-development" class="nav-list-link">13 - Continuous Development</a></li><li class="nav-list-item "><a href="/CS4530-Fall-2024/modules/14-cloud-infrastructure" class="nav-list-link">14 - Cloud Infrastructure</a></li><li class="nav-list-item "><a href="/CS4530-Fall-2024/modules/15-security" class="nav-list-link">15 - Security</a></li><li class="nav-list-item "><a href="/CS4530-Fall-2024/modules/16-open-source" class="nav-list-link">16 - Open Source</a></li><li class="nav-list-item "><a href="/CS4530-Fall-2024/modules/17-ethics" class="nav-list-link">17 - Ethics and Equity in SE</a></li><li class="nav-list-item "><a href="/CS4530-Fall-2024/modules/16a-dependencies" class="nav-list-link">16A - Dependencies</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Assignments category" aria-pressed="false">
          <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
        </button><a href="/CS4530-Fall-2024/assignments/" class="nav-list-link">Assignments</a><ul class="nav-list"><li class="nav-list-item "><a href="/CS4530-Fall-2024/assignments/ip1" class="nav-list-link">Individual Project 1</a></li><li class="nav-list-item "><a href="/CS4530-Fall-2024/assignments/ip2" class="nav-list-link">Individual Project 2</a></li><li class="nav-list-item "><a href="/CS4530-Fall-2024/assignments/project-overview" class="nav-list-link">Project Overview</a></li><li class="nav-list-item "><a href="/CS4530-Fall-2024/assignments/project-plan" class="nav-list-link">Preliminary Project Plan</a></li><li class="nav-list-item "><a href="/CS4530-Fall-2024/assignments/revised-project-plan" class="nav-list-link">Revised Project Plan</a></li><li class="nav-list-item "><a href="/CS4530-Fall-2024/assignments/project-deliverable" class="nav-list-link">Project Final Deliverable</a></li><li class="nav-list-item "><a href="/CS4530-Fall-2024/assignments/project-grading" class="nav-list-link">Final Project Grading</a></li></ul></li><li class="nav-list-item active"><button class="nav-list-expander btn-reset" aria-label="toggle items in Tutorials category" aria-pressed="true">
          <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
        </button><a href="/CS4530-Fall-2024/tutorials/" class="nav-list-link">Tutorials</a><ul class="nav-list"><li class="nav-list-item "><a href="/CS4530-Fall-2024/tutorials/week1-getting-started" class="nav-list-link">Installing a Development Environment</a></li><li class="nav-list-item "><a href="/CS4530-Fall-2024/tutorials/week1-typescript-basics" class="nav-list-link">Typescript Basics</a></li><li class="nav-list-item "><a href="/CS4530-Fall-2024/tutorials/week1-user-stories" class="nav-list-link">User Stories and Conditions of Satisfaction</a></li><li class="nav-list-item "><a href="/CS4530-Fall-2024/tutorials/week1-unit-testing" class="nav-list-link">Unit Testing with Jest</a></li><li class="nav-list-item  active"><a href="/CS4530-Fall-2024/tutorials/week1-mongodb-mongoose" class="nav-list-link active">MongoDB and Mongoose</a></li><li class="nav-list-item "><a href="/CS4530-Fall-2024/tutorials/week1-apirequests-postman" class="nav-list-link">Guide to API Requests and Installing Postman</a></li><li class="nav-list-item "><a href="/CS4530-Fall-2024/tutorials/week4-react-basics" class="nav-list-link">React Tutorial</a></li><li class="nav-list-item "><a href="/CS4530-Fall-2024/tutorials/week5-socketio-basics" class="nav-list-link">Socket.IO Tutorial</a></li><li class="nav-list-item "><a href="/CS4530-Fall-2024/tutorials/week6-cypress" class="nav-list-link">UI Testing with Cypress</a></li></ul></li><li class="nav-list-item"><a href="/CS4530-Fall-2024/textbooks/" class="nav-list-link">Textbooks</a></li><li class="nav-list-item"><a href="/CS4530-Fall-2024/staff/" class="nav-list-link">Staff</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Policies category" aria-pressed="false">
          <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg>
        </button><a href="/CS4530-Fall-2024/policies/" class="nav-list-link">Policies</a><ul class="nav-list"><li class="nav-list-item "><a href="/CS4530-Fall-2024/policies/style/" class="nav-list-link">Code Style</a></li><li class="nav-list-item "><a href="/CS4530-Fall-2024/policies/debugging/" class="nav-list-link">Debugging</a></li></ul></li><li class="nav-list-item"><a href="/CS4530-Fall-2024/resources/" class="nav-list-link">Other Resources</a></li></ul>

    
  </nav>

  
  
    <footer class="site-footer">
      This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.
    </footer>
  
</div>

  <div class="main" id="top">
    <div id="main-header" class="main-header">
  
    

<div class="search" role="search">
  <div class="search-input-wrap">
    <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search CS4530, Fall 2024" aria-label="Search CS4530, Fall 2024" autocomplete="off">
    <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label>
  </div>
  <div id="search-results" class="search-results"></div>
</div>

  
  
  
</div>

    <div id="main-content-wrap" class="main-content-wrap">
      <nav aria-label="Breadcrumb" class="breadcrumb-nav">
  <ol class="breadcrumb-nav-list">
  
    <li class="breadcrumb-nav-list-item"><a href="/CS4530-Fall-2024/tutorials/">Tutorials</a></li>
  <li class="breadcrumb-nav-list-item"><span>MongoDB and Mongoose</span></li>
  </ol>
</nav>
      <div id="main-content" class="main-content">
        <main>
          
            <div class="fs-1 text-right fw-300">Last updated: Nov 19, 24 23:52 UTC | <a href="/CS4530-Fall-2024/tutorials/week1-mongodb-mongoose">Permalink</a></div>
<h1 id="a-mini-tutorial-on-mongodb-and-mongoose">
  
  
    <a href="#a-mini-tutorial-on-mongodb-and-mongoose" class="anchor-heading" aria-labelledby="a-mini-tutorial-on-mongodb-and-mongoose"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> A mini-tutorial on MongoDB and Mongoose
  
  
</h1>
    

<p>This tutorial provides basic introduction to MondoDB and Mongoose:</p>

<p>Contents:</p>
<ul>
  <li><a href="#mongodb-concepts">MongoDB Concepts</a></li>
  <li><a href="#mongoose-representation-of-mongodb-concepts">Mongoose representation of MongoDB Concepts</a></li>
  <li><a href="#databases-collections-and-documents">Databases, Collections, and Documents</a></li>
  <li><a href="#objectids-and-references">ObjectIDs and References</a></li>
  <li><a href="#queries">Queries</a></li>
  <li><a href="#examples">Examples</a></li>
  <li><a href="#resources">Resources</a></li>
</ul>
<h2 id="mongodb-concepts">
  
  
    <a href="#mongodb-concepts" class="anchor-heading" aria-labelledby="mongodb-concepts"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> MongoDB Concepts
  
  
</h2>
    

<ul>
  <li>An <em>installation</em> consists of a set of named <em>databases</em>.</li>
  <li>A <em>database</em> consists of a set of named <em>collections</em>.</li>
  <li>A <em>collection</em> consists of a set of <em>documents</em>.</li>
  <li>A <em>document</em> is a set of (property,value) pairs.</li>
  <li>A <em>schema</em> is a set of (property,type) pairs. All of the documents in a single collection should satisfy the same <em>schema</em>.</li>
</ul>
<h2 id="mongoose-representation-of-mongodb-concepts">
  
  
    <a href="#mongoose-representation-of-mongodb-concepts" class="anchor-heading" aria-labelledby="mongoose-representation-of-mongodb-concepts"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Mongoose representation of MongoDB Concepts
  
  
</h2>
    
<h3 id="databases-collections-and-documents">
  
  
    <a href="#databases-collections-and-documents" class="anchor-heading" aria-labelledby="databases-collections-and-documents"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Databases, Collections, and Documents
  
  
</h3>
    

<p>Mongoose provides representations of MongoDB concepts in the TypeScript/JavaScript language.</p>

<ul>
  <li>In any given program <code class="language-plaintext highlighter-rouge">mongoose</code> refers to a particular database in a particular MongoDB instance. For example, executing</li>
</ul>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">await</span> <span class="nx">mongoose</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="dl">"</span><span class="s2">mongodb://127.0.0.1:27017/pets</span><span class="dl">"</span><span class="p">);</span>
</code></pre></div></div>

<p>causes mongoose to refer to the <code class="language-plaintext highlighter-rouge">pets</code> database in the local MongoDB instance.</p>

<ul>
  <li>A MongoDB schema is represented in Mongoose by an object of class <code class="language-plaintext highlighter-rouge">mongoose.Schema</code>.
For example, executing</li>
</ul>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">kittySchema</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">mongoose</span><span class="p">.</span><span class="nx">Schema</span><span class="p">({</span>
  <span class="na">name</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
  <span class="na">color</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
<span class="p">});</span>
</code></pre></div></div>

<p>causes <code class="language-plaintext highlighter-rouge">kittySchema</code> to represent a Mongo schema with a single property, <code class="language-plaintext highlighter-rouge">name</code>, of type <code class="language-plaintext highlighter-rouge">String</code>.</p>

<p>References to other documents are represented by properties with type <code class="language-plaintext highlighter-rouge">Types.ObjectID</code> (more on this later)</p>

<p>In this document, we will use the terms ‘property’ and ‘field’ interchangeably.</p>

<ul>
  <li>A MongoDB collection of documents
is represented in Mongoose by a TypeScript constructor created by <code class="language-plaintext highlighter-rouge">mongoose.model</code>. For example</li>
</ul>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">Kitten</span> <span class="o">=</span> <span class="nx">mongoose</span><span class="p">.</span><span class="nx">model</span><span class="p">(</span><span class="dl">"</span><span class="s2">Kitten</span><span class="dl">"</span><span class="p">,</span> <span class="nx">kittySchema</span><span class="p">);</span>
</code></pre></div></div>

<p>causes <code class="language-plaintext highlighter-rouge">Kitten</code> to refer to a collection named ‘Kitten’ in the current instance; all the documents in the <code class="language-plaintext highlighter-rouge">Kitten</code> collection should satisfy the schema represented by <code class="language-plaintext highlighter-rouge">kittySchema</code>.</p>

<ul>
  <li>A document with schema <code class="language-plaintext highlighter-rouge">M</code> is represented by a TypeScript object created by saying <code class="language-plaintext highlighter-rouge">new C</code>, where <code class="language-plaintext highlighter-rouge">C</code> is constructor created by <code class="language-plaintext highlighter-rouge">mongoose.model</code>. For example</li>
</ul>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">fluffy</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Kitten</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">fluffy</span><span class="dl">"</span><span class="p">,</span> <span class="na">color</span><span class="p">:</span> <span class="dl">"</span><span class="s2">black</span><span class="dl">"</span> <span class="p">});</span>
</code></pre></div></div>

<p>creates a document intended for insertion in the collection named <code class="language-plaintext highlighter-rouge">Kitten</code>.</p>

<ul>
  <li>In Mongoose, creation of a document is separate from being inserted in a collection. So to actually insert <code class="language-plaintext highlighter-rouge">fluffy</code> in the <code class="language-plaintext highlighter-rouge">Kitten</code> collection, we need to execute</li>
</ul>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">await</span> <span class="nx">fluffy</span><span class="p">.</span><span class="nx">save</span><span class="p">();</span>
</code></pre></div></div>

<p>Note that most of the operations that touch the database are asyncs.</p>
<h3 id="objectids-and-references">
  
  
    <a href="#objectids-and-references" class="anchor-heading" aria-labelledby="objectids-and-references"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> ObjectIDs and References
  
  
</h3>
    

<p>In MongoDB, every document has a unique identifier, which is kept in its <code class="language-plaintext highlighter-rouge">_id</code> field.</p>
<h3 id="queries">
  
  
    <a href="#queries" class="anchor-heading" aria-labelledby="queries"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Queries
  
  
</h3>
    

<p>In Mongoose, a query is a recipe for retrieving documents from a collection. There are <strong>lots</strong> of ways to do this. Here are some that work (for a collection called Dogs)</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">Dog</span><span class="p">.</span><span class="nx">find</span><span class="p">();</span> <span class="c1">// finds all documents in the `Dog` collection</span>
<span class="nx">Dog</span><span class="p">.</span><span class="nx">findOne</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Buddy</span><span class="dl">"</span> <span class="p">});</span> <span class="c1">// finds one of the dogs named 'Buddy'</span>
<span class="nx">Dog</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span> <span class="na">breed</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Labrador</span><span class="dl">"</span> <span class="p">});</span> <span class="c1">// finds all dogs of the given breed</span>
</code></pre></div></div>

<p>These are all asyncs, so you need to <code class="language-plaintext highlighter-rouge">await</code> them.</p>

<p>The query syntax offers lots of methods for selecting, sorting, etc. Take a look at this example, which two very different ways of writing the same query:</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// With a JSON doc</span>
<span class="nx">Person</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span>
  <span class="na">occupation</span><span class="p">:</span> <span class="sr">/host/</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">name.last</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Ghost</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">age</span><span class="p">:</span> <span class="p">{</span> <span class="na">$gt</span><span class="p">:</span> <span class="mi">17</span><span class="p">,</span> <span class="na">$lt</span><span class="p">:</span> <span class="mi">66</span> <span class="p">},</span>
  <span class="na">likes</span><span class="p">:</span> <span class="p">{</span> <span class="na">$in</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">vaporizing</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">talking</span><span class="dl">"</span><span class="p">]</span> <span class="p">},</span>
<span class="p">})</span>
  <span class="p">.</span><span class="nx">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">sort</span><span class="p">({</span> <span class="na">occupation</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span> <span class="p">})</span>
  <span class="p">.</span><span class="nx">select</span><span class="p">({</span> <span class="na">name</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="na">occupation</span><span class="p">:</span> <span class="mi">1</span> <span class="p">})</span>
  <span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>

<span class="c1">// Using query builder</span>
<span class="nx">Person</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span> <span class="na">occupation</span><span class="p">:</span> <span class="sr">/host/</span> <span class="p">})</span>
  <span class="p">.</span><span class="nx">where</span><span class="p">(</span><span class="dl">"</span><span class="s2">name.last</span><span class="dl">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">equals</span><span class="p">(</span><span class="dl">"</span><span class="s2">Ghost</span><span class="dl">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">where</span><span class="p">(</span><span class="dl">"</span><span class="s2">age</span><span class="dl">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">gt</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">lt</span><span class="p">(</span><span class="mi">66</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">where</span><span class="p">(</span><span class="dl">"</span><span class="s2">likes</span><span class="dl">"</span><span class="p">)</span>
  <span class="p">.</span><span class="k">in</span><span class="p">([</span><span class="dl">"</span><span class="s2">vaporizing</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">talking</span><span class="dl">"</span><span class="p">])</span>
  <span class="p">.</span><span class="nx">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="dl">"</span><span class="s2">-occupation</span><span class="dl">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="dl">"</span><span class="s2">name occupation</span><span class="dl">"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">callback</span><span class="p">);</span>
</code></pre></div></div>

<p>For small projects like the one in the course, it is probably preferable to
use the simplest Mongoose queries you can, and then process the list of documents that the query returns.</p>

<p>There are some circumstances where it is helpful to the query do more work. Consider, for example, the following excerpt from <code class="language-plaintext highlighter-rouge">models/application.ts</code></p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">q</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">QuestionModel</span><span class="p">.</span><span class="nx">findOneAndUpdate</span><span class="p">(</span>
  <span class="p">{</span> <span class="na">_id</span><span class="p">:</span> <span class="k">new</span> <span class="nx">ObjectId</span><span class="p">(</span><span class="nx">qid</span><span class="p">)</span> <span class="p">},</span>
  <span class="p">{</span> <span class="na">$inc</span><span class="p">:</span> <span class="p">{</span> <span class="na">views</span><span class="p">:</span> <span class="mi">1</span> <span class="p">}</span> <span class="p">},</span>
  <span class="p">{</span> <span class="na">new</span><span class="p">:</span> <span class="kc">true</span> <span class="p">}</span>
<span class="p">).</span><span class="nx">populate</span><span class="p">({</span> <span class="na">path</span><span class="p">:</span> <span class="dl">"</span><span class="s2">answers</span><span class="dl">"</span><span class="p">,</span> <span class="na">model</span><span class="p">:</span> <span class="nx">AnswerModel</span> <span class="p">});</span>
<span class="k">return</span> <span class="nx">q</span><span class="p">;</span>
</code></pre></div></div>

<p>Here we are give an objectID <code class="language-plaintext highlighter-rouge">qid</code>. The call to <code class="language-plaintext highlighter-rouge">.findOneAndUpdate</code> first finds a document whose <code class="language-plaintext highlighter-rouge">_id</code> field matches <code class="language-plaintext highlighter-rouge">qid</code>. It then calls the document’s <code class="language-plaintext highlighter-rouge">$inc</code> method to increment its <code class="language-plaintext highlighter-rouge">views</code> field by 1. The default behavior of <code class="language-plaintext highlighter-rouge">findOneAndUpdate</code> is to return the original (unmodified) document. But that’s not what we wanted here, so we add a third argument <code class="language-plaintext highlighter-rouge">{ new: true }</code> to return the updated document. All that would be hard to do except by making it part of <code class="language-plaintext highlighter-rouge">findOneAndUpdate</code>.</p>
<h3 id="examples">
  
  
    <a href="#examples" class="anchor-heading" aria-labelledby="examples"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Examples
  
  
</h3>
    
<p>A simple example (i.e, example.ts) can be accessed <a href="./assets/week1-mongodb-mongoose/tutorial.zip">here</a>.</p>
<h3 id="resources">
  
  
    <a href="#resources" class="anchor-heading" aria-labelledby="resources"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Resources
  
  
</h3>
    

<ul>
  <li><a href="https://mongoosejs.com/docs/typescript.html">Official Mongoose/TypeScript docs</a></li>
  <li><a href="https://mongoosejs.com/docs/queries.html">Mongoose Queries</a></li>
</ul>

          

          
        </main>
        

  <hr>
  <footer>
    

    <p class="text-small text-grey-dk-100 mb-0">&copy; 2024 Adeel Bhutta and Mitch Wand. Released under the <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA</a> license</p>

    
  </footer>


      </div>
    </div>
    
      

<div class="search-overlay"></div>

    
  </div>

  
</body>
</html>

